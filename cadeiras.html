<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>cadeiras</title>
    <link rel="stylesheet" href="./styles/output.css" />
    <link rel="stylesheet" href="./styles/styles.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
      integrity="sha512-Fo3rlrZj/k7ujTnHg4CGR2D7kSs0v4LLanw2qksYuRlEzO+tcaEPQogQ0KaoGN26/zrn20ImR1DfuLWnOo7aBA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <!--font -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400..900&display=swap"
      rel="stylesheet"
    />
  </head>
  <body class="flex justify-center items-center h-screen ">
   
    <div class="absolute inset-0 z-10  ">
      <img
        src="./img.formulario/fundo.jpg"
        alt=""
        class="w-full h-full "
      />
      <div
        class="absolute inset-0 bg-gradient-to-b from-[rgba(0,0,0,0.0)] via-black/10 to-black"
      ></div>
    </div>

    
    <form 
      id="form"
      class="flex flex-col relative z-30 justify-center border-0 items-center h-[90%] w-[50%] space-y-6 bg-black opacity-70 rounded-3xl shadow-slate-400 shadow-lg"
    >
      <h1 class="text-white font-cinzel text-2xl font-bold ">
        Escolha os assentos
      </h1>
      <span class="w-[80%] font-cinzel text-white">
        Escolha
        <span
          id="qtdingressos"
          class="font-extrabold text-2xl text-orange-800"
        ></span>
        poltrona(s)
      </span>
      <span class="w-[80%] font-cinzel text-white">
        Selecione seu(s) lugar(es) clicando na(s) poltrona(s) de acordo com a
        legenda. Para desmarcar seu(s) lugar(es) clique novamente sobre a(s)
        poltrona(s) reservada(s)
      </span>

      <div class="flex w-full h-72 justify-center gap-2">
        <div
          id="fileira"
          class="flex flex-col p-4 items-center mt-7 space-y-5 h-full w-14"
        ></div>
        <div class="w-[70%] h-72 border-2">
          <h1 class="bg-orange-900 w-full h-[10%] text-center text-white">TELA</h1>
          <div
            id="assentos"
            class="grid p-4 bg-gray-800 grid-cols-10 gap-2 w-full h-[90%]"
          ></div>
        </div>
      </div>

      <button
      type="submit"
        
        class="w-[50%] text-white rounded-sm font-cinzel font-bold hover:bg-orange-600 bg-orange-900"
      >
        continuar
      </button>
    </form>

    <script>
      const divAssentos = document.getElementById("assentos");
      const fileira = document.getElementById("fileira");

      // Evento de clique em cada cadeira, limite de seleções, seleções feitas, identificar o processo do clique
      const letrafileira = ["A", "B", "C", "D", "E"]; // Corrigido para serem strings
      let selecoes = 0;
      let arrayselecoes = [];
      const quatidadeinteira =
        parseInt(localStorage.getItem("quantidadeinteira")) || 0;
      const quatidademeia =
        parseInt(localStorage.getItem("quantidademeia")) || 0;
      let qtdingressostotal = quatidadeinteira + quatidademeia;
      const selecoeslimite = qtdingressostotal;
      const qtdingressos = document.getElementById("qtdingressos");
      qtdingressos.textContent = qtdingressostotal;

      // Loop para criar os assentos
      for (let i = 0; i <= 49; i++) {
        const chair = document.createElement("div");
        chair.classList.add(
          "hover:bg-green-500",
          "bg-gray-300",
          "text-center",
          "py-1",
          "h-8",
          "w-8",
          "rounded-full",
          "cursor-pointer"
        );

        const letra = letrafileira[Math.floor(i / 10)];
        const cadeira = i + 1;
        chair.textContent = `${letra}${cadeira} `;
        chair.id = `${letra}${cadeira} `;

        // Adiciona evento de clique para selecionar/desselecionar o assento
        chair.addEventListener("click", function () {
          if (chair.classList.contains("bg-green-300")) {
            chair.classList.remove("bg-green-300");
            chair.classList.add("bg-gray-300");
            arrayselecoes = arrayselecoes.filter((item) => item !== chair.id);
            selecoes--;
          } else {
            if (selecoes < selecoeslimite) {
              chair.classList.remove("bg-gray-300");
              chair.classList.add("bg-green-300");
              arrayselecoes.push(chair.id);
              selecoes++;
            } else {
              alert("Você não pode escolher mais assentos");
            }
          }
          console.log(arrayselecoes);
        });

        divAssentos.appendChild(chair);
      }

      // Criação das fileiras
      for (let i = 0; i < letrafileira.length; i++) {
        const linha = document.createElement("div");
        linha.classList.add(
          "bg-gray-300",
          "text-center",
          "h-7",
          "w-8",
          "rounded-sm"
        );
        linha.textContent = letrafileira[i];
        fileira.appendChild(linha);
      }

      const form = document.getElementById("form");

      // pega o evento de submit
      form.addEventListener("submit", function (event) {
        event.preventDefault(); // previne ação padrão do formulário

        // Cria um FormData a partir do formulário
        const formData = new FormData(form);

        const dados = Object.fromEntries(formData.entries());

        // Envia os dados usando fetch
        fetch("http://127.0.0.1:5501/submit", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify(dados),
        })
          .then((response) => {
            if (!response.ok) {
              throw new Error("Erro na requisição");
            }
            return response.json();
          })
          .then((data) => {
            console.log(data);
          })
          .catch((error) => {
            console.error("Erro:", error);
          });
      });
    </script>
  </body>
</html>
